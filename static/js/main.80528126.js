(()=>{"use strict";var e={1719:(e,t,r)=>{r.r(t),r.d(t,{default:()=>O});var n=r(6665),o=r(6520),a=r(6494),l=r(3929),s=r(6283),i=r(5648),d=r(5675),c=r(1690),u=r(6773),f=r(530),g=r(2772),h=r(2660),m=r(6725),x=(r(4241),r(7843)),y=r(1917),p=r(6124),j=r(397);(0,x.enableScreens)();const{width:B,height:b}=m.default.get("window"),S={cguerreiro:"Carlos Guerreiro",lmurtinha:"Luis Murtinha",mcampos:"Marco Campos"},C=["Bancas: 82, 83","Loja 1","Loja 2","Espa\xe7o n.\xba 4"],T={"Banca 82, 83":"Ramiro Ant\xf3nio Gon\xe7alves ","Loja 1":"Maria de Nazar\xe9 dos Reis Santos","Loja 2":"C\xe9lia Maria Martins das Neves","Espa\xe7o n.\xba 4":"BY FAMILY"},R={"Banca 82, 83":"Corredor Sul/Nascente","Loja 1":"Corredor Sul/Nascente","Loja 2":"Corredor Sul/Nascente","Espa\xe7o n.\xba 4":"\xc1rea de Restaura\xe7\xe3o"},P=({navigation:e})=>{const[t,r]=(0,n.useState)(""),[o,a]=(0,n.useState)(""),d=[{username:"cguerreiro",password:"mml1908"},{username:"lmurtinha",password:"mml1908"},{username:"mcampos",password:"mml1908"}];return(0,j.jsxs)(l.default,{style:z.container,children:[(0,j.jsx)(s.default,{style:z.title,children:"Login"}),(0,j.jsx)(u.default,{style:z.input,placeholder:"Nome de Utilizador",value:t,onChangeText:r}),(0,j.jsx)(u.default,{style:z.input,placeholder:"Senha",secureTextEntry:!0,value:o,onChangeText:a}),(0,j.jsx)(i.default,{style:z.loginButton,onPress:()=>{const r=d.find((e=>e.username===t&&e.password===o));if(r){const t=S[r.username];e.navigate("AttendanceScreen",{username:t})}else c.default.alert("Erro","Utilizador ou senha incorretos")},children:(0,j.jsx)(s.default,{style:z.loginButtonText,children:"Entrar"})})]})},w=({route:e,navigation:t})=>{const{username:r}=e.params,[o,a]=(0,n.useState)("");return(0,n.useEffect)((()=>{const e=setInterval((()=>{const e=new Date,t=`${e.toLocaleDateString("pt-PT")} ${e.toLocaleTimeString("pt-PT")}`;a(t)}),1e3);return()=>clearInterval(e)}),[]),(0,j.jsxs)(l.default,{style:z.container,children:[(0,j.jsxs)(s.default,{style:z.greeting,children:["Ol\xe1, ",r]}),(0,j.jsx)(s.default,{style:z.dateTime,children:o}),(0,j.jsx)(i.default,{style:z.startButton,onPress:()=>t.navigate("ModoRegistoScreen",{username:r}),children:(0,j.jsx)(s.default,{style:z.startButtonText,children:"Registo de Assiduidade"})}),(0,j.jsx)(i.default,{style:z.disabledButton,disabled:!0,children:(0,j.jsx)(s.default,{style:z.disabledButtonText,children:"Registo de Incumprimento"})}),(0,j.jsx)(i.default,{style:z.disabledButton,disabled:!0,children:(0,j.jsx)(s.default,{style:z.disabledButtonText,children:"Contactos"})})]})},v=({route:e,navigation:t})=>{const{username:r}=e.params,[o,a]=(0,n.useState)({}),[d,u]=(0,n.useState)(""),[m,x]=(0,n.useState)(!0),[y,p]=(0,n.useState)(!1);(0,n.useEffect)((()=>{B()}),[]);const B=async()=>{x(!0);const e=["Corredor Sul/Poente","Corredor Sul/Central","Corredor Sul/Nascente","Corredor Norte/Nascente","Corredor Norte/Central","Corredor Norte/Poente","\xc1rea de Restaura\xe7\xe3o"],t=(new Date).getDate();let r={},n={MC:"Marco Campos",LM:"Luis Murtinha",CG:"Carlos Guerreiro"};try{const o=`https://script.google.com/macros/s/AKfycbwFXL9TlYOTaILPD0hT-tjn5BycAWxhe10Gfo8IgF-Vg51hJVpGkBR5RCFVNYv0LOtd/exec?day=${t}&corridors=${encodeURIComponent(JSON.stringify(e))}`,l=await fetch(o),s=await l.text();c.default.alert("Response",`URL: ${o}\n\nResponse: ${s}`);const i=JSON.parse(s);for(let t of e)i[t]&&i[t].attendanceCompleted?(r[t]=!0,i[t].attendanceCompletedBy&&u(n[i[t].attendanceCompletedBy]||"")):r[t]=!1;a((e=>Object.assign({},e,r)))}catch(o){console.error("Error fetching attendance status:",o),c.default.alert("Error",`Failed to fetch attendance status: ${o.message}`)}finally{x(!1)}},b=(e,n,a)=>{const l=e.filter((e=>!o[e]));t.navigate("RegistoScreen",{sequence:l,headerTitle:n,corridor:a,username:r})};return m?(0,j.jsx)(l.default,{style:z.container,children:(0,j.jsx)(f.default,{size:"large",color:"#0000ff"})}):(0,j.jsxs)(g.default,{contentContainerStyle:z.container,refreshControl:(0,j.jsx)(h.default,{refreshing:y,onRefresh:async()=>{p(!0);try{await B()}catch(e){console.error("Error refreshing data:",e)}finally{p(!1)}}}),children:[(0,j.jsx)(s.default,{style:z.titleTop,children:"Modo de registo"}),(0,j.jsx)(i.default,{style:[z.rondaButton,Object.keys(o).some((e=>o[e]))?z.greenButton:z.redButton],onPress:()=>b(C,"Ronda Completa","Ronda Completa"),children:(0,j.jsx)(s.default,{style:z.rondaButtonText,children:"Ronda"})}),(0,j.jsx)(s.default,{style:z.subTitle,children:"Corredores"}),(0,j.jsxs)(l.default,{style:z.row,children:[(0,j.jsx)(i.default,{style:[z.tallButton,o["Corredor Norte/Poente"]?z.greenButton:z.redButton],onPress:()=>b(["Banca 41","Banca 42","Loja 26"],"Corredor Norte/Poente","Corredor Norte/Poente"),children:(0,j.jsx)(s.default,{style:z.buttonText,children:"Norte Poente"})}),(0,j.jsx)(i.default,{style:[z.tallButton,o["Corredor Norte/Central"]?z.greenButton:z.redButton],onPress:()=>b(["Banca 15, 16, 17","Banca 40"],"Corredor Norte/Central","Corredor Norte/Central"),children:(0,j.jsx)(s.default,{style:z.buttonText,children:"Norte Central"})}),(0,j.jsx)(i.default,{style:[z.tallButton,o["Corredor Norte/Nascente"]?z.greenButton:z.redButton],onPress:()=>b(["Banca 3","Banca 4","Loja 14"],"Corredor Norte/Nascente","Corredor Norte/Nascente"),children:(0,j.jsx)(s.default,{style:z.buttonText,children:"Norte Nascente"})})]}),(0,j.jsx)(i.default,{style:[z.smallSquareButton,o["\xc1rea de Restaura\xe7\xe3o"]?z.greenButton:z.redButton],onPress:()=>b(["Espa\xe7o n.\xba 1","Espa\xe7o n.\xba 2","Espa\xe7o n.\xba 3","Espa\xe7o n.\xba 4"],"Espa\xe7os Restaura\xe7\xe3o","\xc1rea de Restaura\xe7\xe3o"),children:(0,j.jsx)(s.default,{style:z.buttonText,children:"Pra\xe7a Central"})}),(0,j.jsxs)(l.default,{style:z.row,children:[(0,j.jsx)(i.default,{style:[z.tallButton,o["Corredor Sul/Poente"]?z.greenButton:z.redButton],onPress:()=>b(["Banca 56, 71","Banca 57, 58","Banca 63"],"Corredor Sul/Poente","Corredor Sul/Poente"),children:(0,j.jsx)(s.default,{style:z.buttonText,children:"Sul Poente"})}),(0,j.jsx)(i.default,{style:[z.tallButton,o["Corredor Sul/Central"]?z.greenButton:z.redButton],onPress:()=>b(["Banca 64","Banca 65","Banca 81"],"Corredor Sul/Central","Corredor Sul/Central"),children:(0,j.jsx)(s.default,{style:z.buttonText,children:"Sul Central"})}),(0,j.jsx)(i.default,{style:[z.tallButton,o["Corredor Sul/Nascente"]?z.greenButton:z.redButton],onPress:()=>b(["Banca 82, 83","Loja 7"],"Corredor Sul/Nascente","Corredor Sul/Nascente"),children:(0,j.jsx)(s.default,{style:z.buttonText,children:"Sul Nascente"})})]}),d?(0,j.jsxs)(s.default,{style:z.completedByText,children:["Assiduidade feita por: ",d]}):null]})},N=({route:e,navigation:t})=>{const{sequence:r,corridor:o,username:a}=e.params,[d,c]=(0,n.useState)(0),[u,f]=(0,n.useState)(0),[g,h]=(0,n.useState)({}),[m,x]=(0,n.useState)({}),[p,B]=(0,n.useState)({}),b=r[d]||"",S=T[b]||"Nome n\xe3o encontrado",C=R[b]||o||"";(0,n.useEffect)((()=>{console.log(`currentPlace: ${b}, nome: ${S}`)}),[b]);const P=()=>{const e=d+1;e<r.length?(c(e),f(Math.max(u,e))):t.navigate("SummaryScreen",{faltas:g,presencas:m,corridor:o,username:a})},w=p[b];return(0,j.jsxs)(l.default,{style:z.container,children:[(0,j.jsx)(s.default,{style:z.corridor,children:String(C)})," ",(0,j.jsx)(s.default,{style:z.nome,children:String(S)})," ",(0,j.jsx)(s.default,{style:z.bancaTitle,children:String(b)})," ",(0,j.jsxs)(l.default,{style:z.fullWidthButtons,children:[(0,j.jsxs)(i.default,{style:[z.fullWidthButton,z.faltaButton],onPress:()=>{h((e=>Object.assign({},e,{[b]:1}))),B((e=>Object.assign({},e,{[b]:"falta"}))),P()},children:[(0,j.jsx)(s.default,{style:z.buttonText,children:"Falta"}),"falta"===w&&(0,j.jsx)(y.default,{name:"checkmark-circle",size:24,color:"white",style:z.checkmark})]}),(0,j.jsxs)(i.default,{style:[z.fullWidthButton,z.presenteButton],onPress:()=>{x((e=>Object.assign({},e,{[b]:1}))),B((e=>Object.assign({},e,{[b]:"presente"}))),P()},children:[(0,j.jsx)(s.default,{style:z.buttonText,children:"Presente"}),"presente"===w&&(0,j.jsx)(y.default,{name:"checkmark-circle",size:24,color:"white",style:z.checkmark})]})]})]})},k=({route:e,navigation:t})=>{const{faltas:r,presencas:n,corridor:o,username:a}=e.params;return(0,j.jsxs)(l.default,{style:z.container,children:[(0,j.jsx)(s.default,{style:z.title,children:"Resumo do Dia"}),(0,j.jsxs)(s.default,{style:z.summaryText,children:["Faltas Lojas: ",F("Loja",r)]}),(0,j.jsxs)(s.default,{style:z.summaryText,children:["Faltas Bancas: ",F("Banca",r)]}),(0,j.jsxs)(s.default,{style:z.summaryText,children:["Faltas Totais: ",Object.values(r).reduce(((e,t)=>e+(1===t||"DE"===t||"FE"===t?1:0)),0)]}),(0,j.jsxs)(s.default,{style:z.summaryText,children:["Presen\xe7as Lojas: ",F("Loja",n)]}),(0,j.jsxs)(s.default,{style:z.summaryText,children:["Presen\xe7as Bancas: ",F("Banca",n)]}),(0,j.jsxs)(s.default,{style:z.summaryText,children:["Presen\xe7as Totais:"," ",Object.values(n).reduce(((e,t)=>e+t),0)]}),(0,j.jsx)(i.default,{style:z.sendButton,onPress:async()=>{const e={mes:(new Date).toLocaleString("default",{month:"long"}),dia:(new Date).getDate(),faltas:Object.keys(r).map((e=>({concessionario:T[e],dia:(new Date).getDate(),reason:r[e]}))),corridor:o,username:a};try{const t=await fetch("https://script.google.com/macros/s/AKfycbx24YwpRLEyhBFLZ-CxuHrhUFk51gag5BllQJh2FcW7ToHserqUeSLXqg65JWzBLRhM/exec",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.text();c.default.alert("Server Response",r)}catch(t){console.error("Error:",t),c.default.alert("Error",`Failed to send attendance data: ${t.message}`)}},children:(0,j.jsx)(s.default,{style:z.sendButtonText,children:"Enviar"})})]})},F=(e,t)=>Object.keys(t).filter((t=>t.includes(e))).reduce(((e,r)=>{const n=t[r];return e+(1===n||"DE"===n||"FE"===n?1:0)}),0),L=(0,a.default)(),z=d.default.create({container:{flex:1,justifyContent:"center",alignItems:"center",padding:.05*B},titleTop:{fontSize:(0,p.RFPercentage)(3.5),marginBottom:.02*b,textAlign:"center"},subTitle:{fontSize:(0,p.RFPercentage)(2.5),marginVertical:.02*b,textAlign:"center"},greeting:{fontSize:(0,p.RFPercentage)(2.5),color:"black"},dateTime:{fontSize:(0,p.RFPercentage)(2),color:"black"},startButton:{marginTop:.05*b,paddingVertical:.02*b,paddingHorizontal:.3*B,backgroundColor:"blue",borderRadius:5},startButtonText:{color:"white",fontSize:(0,p.RFPercentage)(2.5)},disabledButton:{marginTop:.02*b,paddingVertical:.02*b,paddingHorizontal:.3*B,backgroundColor:"gray",borderRadius:5},disabledButtonText:{color:"darkgray",fontSize:(0,p.RFPercentage)(2.5)},rondaButton:{paddingVertical:.02*b,paddingHorizontal:.3*B,borderRadius:5},rondaButtonText:{color:"white",fontSize:(0,p.RFPercentage)(2.5)},row:{flexDirection:"row",justifyContent:"space-between",width:"100%",marginVertical:.01*b},tallButton:{flex:1,marginHorizontal:"1%",paddingVertical:.1*b,borderRadius:5},smallSquareButton:{marginVertical:.03*b,padding:.05*B,borderRadius:5,width:"30%",alignItems:"center"},buttonText:{color:"white",fontSize:(0,p.RFPercentage)(2.5),textAlign:"center"},fullWidthButtons:{flexDirection:"row",width:"100%",height:"50%"},fullWidthButton:{flex:1,justifyContent:"center",alignItems:"center"},faltaButton:{backgroundColor:"red"},presenteButton:{backgroundColor:"green"},corridor:{fontSize:(0,p.RFPercentage)(3.5),color:"black",fontWeight:"bold",textAlign:"center",marginBottom:.02*b},nome:{fontSize:(0,p.RFPercentage)(3),color:"black",textAlign:"center",marginBottom:.02*b},bancaTitle:{fontSize:(0,p.RFPercentage)(2.5),color:"black",textAlign:"center",marginBottom:.05*b},overlayTextContainerLeft:{position:"absolute",top:.05*b,left:.05*B},overlayTextContainerRight:{position:"absolute",top:.05*b,right:.05*B},overlayText:{color:"white",fontSize:(0,p.RFPercentage)(2)},summaryText:{fontSize:(0,p.RFPercentage)(2.5),marginBottom:.02*b,textAlign:"center"},sendButton:{marginTop:.05*b,paddingVertical:.02*b,paddingHorizontal:.3*B,backgroundColor:"blue",borderRadius:5},sendButtonText:{color:"white",fontSize:(0,p.RFPercentage)(2.5)},arrowLeft:{position:"absolute",bottom:.01*b,left:"10%"},arrowRight:{position:"absolute",bottom:.01*b,right:"10%"},checkmark:{marginTop:.01*b},input:{width:"100%",padding:.03*B,marginBottom:.02*b,borderColor:"gray",borderWidth:1,fontSize:(0,p.RFPercentage)(2.5)},loginButton:{marginTop:.05*b,backgroundColor:"blue",paddingVertical:.02*b,paddingHorizontal:.3*B,borderRadius:5},loginButtonText:{color:"white",fontSize:(0,p.RFPercentage)(2.5)},redButton:{backgroundColor:"red"},greenButton:{backgroundColor:"green"},completedByText:{marginTop:.03*b,fontSize:(0,p.RFPercentage)(2.5),color:"black",textAlign:"center"},overlayButtonContainer:{position:"absolute",top:.35*b,left:"10%",flexDirection:"row",justifyContent:"flex-start"},overlayButton:{backgroundColor:"#007bff",paddingVertical:.01*b,paddingHorizontal:.05*B,borderRadius:5,marginRight:.02*B,alignItems:"center"},overlayButtonText:{color:"white",fontSize:(0,p.RFPercentage)(2),textAlign:"center",fontWeight:"bold"}}),O=()=>(0,j.jsx)(o.default,{children:(0,j.jsxs)(L.Navigator,{initialRouteName:"Login",children:[(0,j.jsx)(L.Screen,{name:"Login",component:P}),(0,j.jsx)(L.Screen,{name:"AttendanceScreen",component:w}),(0,j.jsx)(L.Screen,{name:"ModoRegistoScreen",component:v}),(0,j.jsx)(L.Screen,{name:"RegistoScreen",component:N}),(0,j.jsx)(L.Screen,{name:"SummaryScreen",component:k})]})})}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={id:n,loaded:!1,exports:{}};return e[n](a,a.exports,r),a.loaded=!0,a.exports}r.m=e,(()=>{var e=[];r.O=(t,n,o,a)=>{if(!n){var l=1/0;for(c=0;c<e.length;c++){for(var[n,o,a]=e[c],s=!0,i=0;i<n.length;i++)(!1&a||l>=a)&&Object.keys(r.O).every((e=>r.O[e](n[i])))?n.splice(i--,1):(s=!1,a<l&&(l=a));if(s){e.splice(c--,1);var d=o();void 0!==d&&(t=d)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,o,a]}})(),r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),r.p="/",(()=>{var e={792:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var o,a,[l,s,i]=n,d=0;if(l.some((t=>0!==e[t]))){for(o in s)r.o(s,o)&&(r.m[o]=s[o]);if(i)var c=i(r)}for(t&&t(n);d<l.length;d++)a=l[d],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(c)},n=self.webpackChunkweb=self.webpackChunkweb||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=r.O(void 0,[557],(()=>r(5036)));n=r.O(n)})();
//# sourceMappingURL=main.80528126.js.map